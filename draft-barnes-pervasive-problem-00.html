<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Pervasive Attack: A Threat Model and Problem Statement</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Pervasive Attack: A Threat Model and Problem Statement">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">R. Barnes</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">BBN</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">December 09, 2013</td></tr>
<tr><td class="header">Expires: June 12, 2014</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Pervasive Attack: A Threat Model and Problem Statement<br />draft-barnes-pervasive-problem-00</h1>

<h3>Abstract</h3>

<p>Leaks of classified documents in 2013 have revealed several classes of “pervasive” attack on Internet protocols.  In this document, we review the main attacks that have been published, and develop a threat model that describes these pervasive attacks.  Based on this threat model, we discuss the techniques that can be employed in Internet protocol design to make protocols robust in the face of pervasive attack.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on June 12, 2014.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2013 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<a name="introduction"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Starting in the June 2013, documents leaked to the press by Edward Snowden have revealed several operations undertaken by intelligence agencies to exploit Internet communications for intelligence purposes.  These attacks were largely based on protocol vulnerabilities that were already known to exist.  The attacks were nonetheless striking in their pervasive nature, both in terms of the amount of Internet communications targeted, and in terms of the diversity of attack techniques employed.
</p>
<p>In order to ensure the continued security of the Internet, it is necessary for the Internet technical community to address the vulnerabilities exploited in these attacks.  The goal of this document is to describe more precisely the threats posed by these pervasive attacks, and based on those threats, lay out the problems that need to be solved in order to secure the Internet in the face of those threats.
</p>
<p>The remainder of this document is structured as follows.  In <a class='info' href='#reported'>Section&nbsp;3<span> (</span><span class='info'>Reported Instances of Large-Scale Attacks</span><span>)</span></a>, we provide a brief summary of the attacks that have been disclosed.  <a class='info' href='#model'>Section&nbsp;4<span> (</span><span class='info'>Classes of Pervasive Attack</span><span>)</span></a> describes a threat model based on these attacks, focusing on classes of attack that have not been a focus of Internet engineering to date.  <a class='info' href='#response'>Section&nbsp;5<span> (</span><span class='info'>Responding to Pervasive Attack</span><span>)</span></a> provides some high-level guidance on how Internet protocols can defend against the threats described here.
</p>
<a name="terminology"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>This document makes extensive use of standard security terminology; see, for example, <a class='info' href='#RFC4949'>[RFC4949]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a>.  In addition, we use a few terms that are specific to the attacks discussed here:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Pervasive Attack:</dt>
<dd>
  An attack on Internet protocols that makes use of access at a large number of points in the network, or otherwise provides the attacker with access to a large amount of Internet traffic. 
</dd>
<dt>Collaborator:</dt>
<dd>
  An entity that is a legitimate participant in a protocol, but who provides information about that interaction (keys or data) to an attacker.
</dd>
<dt>Key Exfiltration:</dt>
<dd>
  The transmission of keying material for an encrypted communication from a collaborator to an attacker
</dd>
<dt>Content Exfiltration:</dt>
<dd>
  The transmission of the content of a communication from a collaborator to an attaker
</dd>
<dt>Unwitting Collaborator:</dt>
<dd>
  A collaborator that provides information to the attacker not deliberately, but because the attacker has exploited some technology used by the collaborator.
</dd>
</dl></blockquote>

<a name="reported"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Reported Instances of Large-Scale Attacks</h3>

<p>Through recent revelations of sensitive documents in several media outlets, the Internet community has been made aware of several intelligence activites conducted by US and UK national intelligence agencies, particularly the US National Security Agency (NSA) and the UK Government Communications Headquarters (GCHQ).  These documents have revealed the methods that these agencies use to attack Internet applications and obtain sensitive user information. 
</p>
<p></p>
<ul class="text">
<li>Large scale passive collection of Internet traffic <a class='info' href='#pass1'>[pass1]<span> (</span><span class='info'>The Guardian, &ldquo;How the NSA is still harvesting your online data,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#pass2'>[pass2]<span> (</span><span class='info'>The Guardian, &ldquo;NSA's Prism surveillance program: how it works and what it can do,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#pass3'>[pass3]<span> (</span><span class='info'>The Guardian, &ldquo;XKeyscore: NSA tool collects 'nearly everything a user does on the internet',&rdquo; 2013.</span><span>)</span></a><a class='info' href='#pass4'>[pass4]<span> (</span><span class='info'>The Guardian, &ldquo;How does GCHQ's internet surveillance work?,&rdquo; .</span><span>)</span></a>.  For example, the NSA XKEYSCORE system gathers data from multiple access points and searches for “selectors” such as email addresses, at the scale of tens of terabytes of data per day.  The GCHQ Tempora system appears to have access to around 1,500 major cables passing through the UK.
</li>
<li>Decryption of TLS-protected Internet sessions <a class='info' href='#dec1'>[dec1]<span> (</span><span class='info'>The New York Times, &ldquo;N.S.A. Able to Foil Basic Safeguards of Privacy on Web,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#dec2'>[dec2]<span> (</span><span class='info'>The Guardian, &ldquo;Project Bullrun – classification guide to the NSA's decryption program,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#dec3'>[dec3]<span> (</span><span class='info'>The Guardian, &ldquo;Revealed: how US and UK spy agencies defeat internet privacy and security,&rdquo; 2013.</span><span>)</span></a>.  For example, the NSA BULLRUN project appears to have had a budget of around $250M per year to undermine encryption through multiple approaches. 
</li>
<li>Insertion of NSA devices as a man in the middle of Internet transactions <a class='info' href='#TOR1'>[TOR1]<span> (</span><span class='info'>Schneier, B., &ldquo;How the NSA Attacks Tor/Firefox Users With QUANTUM and FOXACID,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#TOR2'>[TOR2]<span> (</span><span class='info'>The Guardian, &ldquo;'Tor Stinks' presentation – read the full document,&rdquo; 2013.</span><span>)</span></a>.  For example, the NSA QUANTUM system appears to be able to hijack HTTP connections via “fast packet injection”.
</li>
<li>Direct acquisition of bulk data and metadata from service providers <a class='info' href='#dir1'>[dir1]<span> (</span><span class='info'>The Guardian, &ldquo;NSA collecting phone records of millions of Verizon customers daily,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#dir2'>[dir2]<span> (</span><span class='info'>The Guardian, &ldquo;NSA Prism program taps in to user data of Apple, Google and others,&rdquo; 2013.</span><span>)</span></a>.  For example, the NSA PRISM program provides the agency with access to many types of user data (e.g., email, chat, VoIP).
</li>
<li>Use of implants (covert modifications or malware) to undermine security and anonymity features <a class='info' href='#dec2'>[dec2]<span> (</span><span class='info'>The Guardian, &ldquo;Project Bullrun – classification guide to the NSA's decryption program,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#TOR1'>[TOR1]<span> (</span><span class='info'>Schneier, B., &ldquo;How the NSA Attacks Tor/Firefox Users With QUANTUM and FOXACID,&rdquo; 2013.</span><span>)</span></a><a class='info' href='#TOR2'>[TOR2]<span> (</span><span class='info'>The Guardian, &ldquo;'Tor Stinks' presentation – read the full document,&rdquo; 2013.</span><span>)</span></a>.  For example, NSA appears to use the QUANTUM man-in-the-middle system to direct users to a FOXACID server, which delivers an implant that makes the TOR anonymity service less effective.  The BULLRUN program mentioned above includes the addition of covert modifications to software as one means to undermine encryption.
</li>
</ul>

<p>We use the term “pervasive attack” to collectively describe these operations.  The term “pervasive” applies in a few ways.  The attacks are physically pervasive; they affect a large number of Internet communications.  They are pervasive in content, consuming and exploiting any information revealed by the protocol.  And they are pervasive in technology, exploiting many different vulnerabilities in many different protocols.
</p>
<a name="model"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Classes of Pervasive Attack</h3>

<p>The primary goal of pervasive attack is collection of information across a large number of Internet communications, including decryption of encrypted communications and deanonymization of anonymized communications.  The attacker can then analyze the collected communications to identify information of interest, or use data mining techniques to examine correlations among multiple communications.
</p>
<p>In order to succeed in this goal, an attacker needs two main things.  First, he needs access to the traffic he wishes to collect.  Second, if the traffic is encrypted, he needs access to key material that can be used to decrypt the traffic.  The attacks listed above highlight new avenues for attack on both of these questions, which have not been a focus of security analysis in the past.
</p>
<a name="attacker-capabilities"></a><br /><hr />
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Attacker Capabilities</h3>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Attack Class</th><th align="left">Capability</th></tr>
<tr>
<td align="left">Passive</td>
<td align="left">Capture data in transit</td>
</tr>
<tr>
<td align="left">Active</td>
<td align="left">Manipulate / inject data in transit</td>
</tr>
<tr>
<td align="left">Static key exfiltration</td>
<td align="left">Obtain key material once / rarely</td>
</tr>
<tr>
<td align="left">Dynamic key exfiltration</td>
<td align="left">Obtain per-session key material</td>
</tr>
<tr>
<td align="left">Content exfiltration</td>
<td align="left">Access data at rest</td>
</tr>
</table>
<br clear="all" />

<p>Security analyses of Internet protocols commonly consider two classes of attacker: Passive attackers, who can simply listen in on communications as they transit the network, and “active attackers”, who can modify or delete packets in addition to simply collecting them.  
</p>
<p>In the context of pervasive attack, these attacks take on an even greater significance.  A passive attacker with access to a large portion of the Internet can analyze collected traffic to create a much more detailed view of user behavior than an attacker that collects at a single point.  Even the usual claim that encryption defeats passive attackers is weakened, since a pervasive passive attacker can examine correlations over large numbers of sessions, e.g., pairing encrypted sessions with unencrypted sessions from the same host.
The NSA XKEYSCORE system would be an example of such an attacker.
</p>
<p>A pervasive active attacker likewise has capabilities beyond those of a localized active attacker.  Active attacks are often limited by network topology, for example by a requirement that the attacker be able to see a targeted session as well as inject packets into it.  A pervasive active attacker with multiple accesses at core points of the Internet is able to overcome these topological limitations and apply attacks over a much broader scope.  Being positioned in the core of the network rather than the edge can also enable a pervasive active attacker to reroute targeted traffic.  Pervasive active attackers can also benefit from pervasive passive collection to identify vulnerable hosts.
</p>
<p>While not directly related to pervasiveness, attackers that are in a position to mount a pervasive active attack are also often in a position to subvert authentication, the traditional response to active attack.  Authentication in the Internet is often achieved via trusted third party authorities such as the Certificate Authorities (CAs) that provide web sites with authentication credentials.  An attacker with sufficient resources for pervasive attack may also be able to force an authority to grant credentials for an identity of the attacker’s choosing, allowing the active attack to succeed where a weaker attacker would fail.
</p>
<p>Beyond these two classes, the BULLRUN effort to defeat encryption and the PRISM effort to obtain data from service providers suggest three more classes of attack:
</p>
<p></p>
<ul class="text">
<li>Static key exfiltration
</li>
<li>Dynamic key exfiltration
</li>
<li>Content exfiltration
</li>
</ul>

<p>These attacks all rely on a “collaborator” endpoint providing the attacker with some information, either keys or data.  These attacks have not traditionally been considered in security analyses of protocols, since they happen outside of the protocol.
</p>
<p>The term “key exfiltration” refers to the transfer of keying material for an encrypted communication from the collaborator to the attacker.  By “static”, we mean that the transfer of keys happens once, or rarely, typically of a long-lived key.  For example, this case would cover a web site operator that provides the private key corresponding to its HTTPS certificate to an intelligence agency.  
</p>
<p>“Dynamic” key exfiltration, by contrast, refers to attacks in which the collaborator delivers keying material to the attacker frequently, e.g., on a per-session basis.  This does not necessarily imply frequent communications with the attacker; the transfer of keying material may be virtual.  For example, if an endpoint were modified in such a way that the attacker could predict the state of its psuedorandom number generator, then the attacker would be able to derive per-session keys even without per-session communications.
</p>
<p>Finally, content exfiltration is the attack in which the collaborator simply provides the attacker with the desired data or metadata.   Unlike the key exfiltration cases, this attack does not require the attacker to capture the desired data as it flows through the network.  The risk is to data at rest as opposed to data in transit.  This increases the scope of data that the attacker can obtain, since the attacker can access historical data – he does not have to be listening at the time the communication happens.
</p>
<p>Exfiltration attacks can be accomplished via attack against the collaborator, i.e., by the attacker stealing the keys or content rather than the collaborator providing them willingly.  In these cases, the collaborator may not be aware that he is collaborating, at least at a human level; the subverted technical assets are doing the collaboration on his behalf.
</p>
<a name="attacker-costs"></a><br /><hr />
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Attacker Costs</h3>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Attack Class</th><th align="left">Cost / Risk to Attacker</th></tr>
<tr>
<td align="left">Passive</td>
<td align="left">Passive data access</td>
</tr>
<tr>
<td align="left">Active</td>
<td align="left">Active data access + processing</td>
</tr>
<tr>
<td align="left">Static key exfiltration</td>
<td align="left">One-time interaction</td>
</tr>
<tr>
<td align="left">Dynamic key exfiltration</td>
<td align="left">Ongoing interaction / code change</td>
</tr>
<tr>
<td align="left">Content exfiltration</td>
<td align="left">Ongoing, bulk interaction</td>
</tr>
</table>
<br clear="all" />

<p>In order to realize an attack of each of the types discussed above, the attacker has to incur certain costs and undertake certain risks.  These costs differ by attack, and can be helpful in guiding response to pervasive attack.  
</p>
<p>Depending on the attack, the attacker may be exposed to several types of risk, ranging from simply losing access to arrest or prosecution.  In order for any of these negative consequences to happen, however, the attacker must first be discovered and identified.  So the primary risk we focus on here is the risk of discovery and attribution.
</p>
<p>A passive attack is the simplest attack to mount in some ways.  The base requirement is that the attacker obtain physical access to a communications medium and extract communications from it.  For example, the attacker might tap a fiber-optic cable, acquire a mirror port on a switch, or listen to a wireless signal.  The need for these taps to have physical access to a link exposes the attacker to the risk that the taps will be discovered.  For example, a fiber tap or mirror port might be discovered by network operators noticing increased attenuation in the fiber or a change in switch configuration.  Of course, passive attacks may be accomplished with the cooperation of the network operator, in which case there is a risk that the attacker’s interactions with the network operator will be exposed.
</p>
<p>In many ways, the costs and risks for an active attack are similar to those for a passive attack, with a few additions.  An active attacker requires more robust network access than a passive attacker, since for example he will often need to transmit data as well as receiving it.  In the wireless example above, the attacker would need to act as an transmitter as well as receiver, greatly increasing the probability he will be discovered (e.g., using direction-finding technology).  Active attacks are also much more observable at higher layers of the network.  For example, an active attacker that attempts to use a mis-issued certificate could be detected via Certificate Transparency <a class='info' href='#RFC6962'>[RFC6962]<span> (</span><span class='info'>Laurie, B., Langley, A., and E. Kasper, &ldquo;Certificate Transparency,&rdquo; June&nbsp;2013.</span><span>)</span></a>.  
</p>
<p>In terms of raw implementation complexity, passive attacks require only enough processing to extract information from the network and store it.  Active attacks, by contrast, often depend on winning race conditions to inject pakets into active connections.  So active attacks in the core of the network require processing hardware to that can operate at line speed to identify opportunities for attack and insert attack traffic in a high-volume traffic.
</p>
<p>Key exfiltration attacks rely on passive attack for access to encrypted data, with the collaborator providing keys to decrypt the data.  So the attacker undertakes the cost and risk of a passive attack, as well as additional risk of discovery via the interactions that the attacker has with the collaborator.  
</p>
<p>In this sense, static exfiltration has a lower risk profile than dynamic.  In the static case, the attacker need only interact with the collaborator a small number of times, possibly only once, say to exchange a private key.  In the dynamic case, the attacker must have continuing interactions with the collaborator.  As noted above these interactions may real, such as in-person meetings, or virtual, such as software modifications that render keys available to the attacker.  Both of these types of interactions introduce a risk that they will be discovered, e.g., by employees of the collaborator organization noticing suspicious meetings or suspicious code changes.
</p>
<p>Content exfiltration has a similar risk profile to dynamic key exfiltration.  In a content exfiltration attack, the attacker saves the cost and risk of conducting a passive attack.  The risk of discovery through interactions with the collaborator, however, is still present, and may be higher.  The content of a communication is obviously larger than the key used to encrypt it, often by several orders of magnitude.  So in the content exfiltration case, the interactions between the collaborator and the attacker need to be much higher-bandwidth than in the key exfiltration cases, with a corresponding increase in the risk that this high-bandwidth channel will be discovered.
</p>
<p>It should also be noted that in these latter three exfiltration cases, the collaborator also undertakes a risk that his collaboration with the attacker will be discovered.  Thus the attacker may have to incur additional cost in order to convince the collaborator to participate in the attack.  Likewise, the scope of these attacks is limited to case where the attacker can convince a collaborator to participate.  If the attacker is a national government, for example, it may be able to compel participation within its borders, but have a much more difficult time recruiting foreign collaborators.
</p>
<p>As noted above, the “collaborator” in an exfiltration attack can be unwitting; the attacker can steal keys or data to enable the attack.  In some ways, the risks of this approach are similar to the case of an active collaborator.  In the static case, the attacker needs to steal information from the collaborator once; in the dynamic case, the attacker needs to continued presence inside the collaborators systems.  The main difference is that the risk in this case is of automated discovery (e.g., by intrusion detection systems) rather than discovery by humans.
</p>
<a name="response"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Responding to Pervasive Attack</h3>

<p>Given this threat model, how should the Internet technical community respond to pervasive attack?  
</p>
<p>The cost and risk considerations discussed above can provide a guide to response.  Namely, responses to passive attack should close off avenues for attack that are safe, scalable, and cheap, forcing the attacker to mount attacks that expose it to higher cost and risk.  
</p>
<p>In this section, we discuss a collection of high-level approaches to mitigating pervasive attacks.  These approaches are not meant to be exhaustive, but rather to provide general guidance to protocol designers in creating protocols that are resistant to pervasive attack.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Attack Class</th><th align="left">High-level mitigations</th></tr>
<tr>
<td align="left">Passive</td>
<td align="left">Encryption, anonymization</td>
</tr>
<tr>
<td align="left">Active</td>
<td align="left">Authentication, monitoring</td>
</tr>
<tr>
<td align="left">Static key exfiltration</td>
<td align="left">Encryption with per-session state (PFS)</td>
</tr>
<tr>
<td align="left">Dynamic key exfiltration</td>
<td align="left">Transparency, validation of end systems</td>
</tr>
<tr>
<td align="left">Content exfiltration</td>
<td align="left">Object encryption, distributed systems</td>
</tr>
</table>
<br clear="all" />

<p>The traditional mitigation to passive attack is to render content unintelligible to the attacker by applying encryption, for example, by using TLS or IPsec <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a><a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.  Even without authentication, encryption will prevent a passive attacker from being able to read the encrypted content.  Exploiting unauthenticated encryption requires an active attack (man in the middle); with authentication, a key exfiltration attack is required.
</p>
<p>The additional capabilities of a pervasive passive attacker, however, require some changes in how protocol designers evaluate what information is encrypted.  In addition to directly collecting unencrypted data, a pervasive passive attacker can also make inferences about the content of encrypted messages based on what is observable.  For example, if a user typically visits a particular set of web sites, then a pervasive passive attacker observing all of the user’s behavior can track the user based on the hosts he communicates with, even if he changes IP addresses, and even if all of the connections are encrypted.  
</p>
<p>Thus, in designing protocols to be resistant to pervasive passive attacks, protocol designers should consider what information is left unencrypted in the protocol, and how that information might be correlated with other traffic.  Information that cannot be encrypted should be anonymized, i.e., it should be randomized so that it cannot be correlated with other information.  For example, the TOR overlay routing network anonymizes IP addresses by using multi-hop onion routing <a class='info' href='#TOR'>[TOR]<span> (</span><span class='info'>The Tor Project, &ldquo;TOR,&rdquo; 2013.</span><span>)</span></a>.
</p>
<p>As with traditional, limited active attacks, the basic mitigation to pervasive active attack is to enable the endpoints of a communication to authenticate each other.  However, as noted above, attackers that can mount pervasive active attacks can often subvert the authorities on which authentication systems rely.  Thus, in order to make authentication systems more resilient to pervasive attack, it is beneficial to monitor these authorities to detect misbehavior that could enable active attack.  For example, DANE and Certificate Transparency both provide mechanisms for detecting when a CA has issued a certificate for a domain name without the authorization of the holder of that domain name <a class='info' href='#RFC6962'>[RFC6962]<span> (</span><span class='info'>Laurie, B., Langley, A., and E. Kasper, &ldquo;Certificate Transparency,&rdquo; June&nbsp;2013.</span><span>)</span></a><a class='info' href='#RFC6698'>[RFC6698]<span> (</span><span class='info'>Hoffman, P. and J. Schlyter, &ldquo;The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA,&rdquo; August&nbsp;2012.</span><span>)</span></a>.
</p>
<p>An encrypted, authenticated session is safe from attacks in which neither end collaborates with the attacker, but can still be subverted by the endpoints.  The most common ciphersuites used for HTTPS today, for example, are based on using RSA encryption in such a way that if an attacker has the private key, he can derive the session keys from passive observation of a session.  These ciphersuites are thus vulnerable to a static key exfiltration attack – if the attacker obtains the server’s private key once, then he can decrypt all past and future sessions for that server.
</p>
<p>Static key exfiltration attacks are prevented by including ephemeral, per-session secret information in the keys used for a session.  Most IETF security protocols include modes of operation that have this property.  These modes are known in the literature under the heading “perfect forward secrecy” (PFS) because even if an adversary has all of the secrets for one session, the next session will use new, different secrets and the attacker will not be able to decrypt it.  The Internet Key Exchange (IKE) protocol used by IPsec supports PFS by default <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, and TLS supports PFS via the use of specific ciphersuites <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p>
<p>Dynamic key exfiltration cannot be prevent by protocol means.  By definition, any secrets that are used in the protocol will be transmitted to the attacker and used to decrypt what the protocol encrypts.  Likewise, no technical means will stop a willing collaborator from sharing keys with an attacker.  However, this attack model also covers “unwitting collaborators”, whose technical resources are collaborating with the attacker without their owners knowledge.  This could happen, for example, if flaws are built in products or if malware is injected later on.  
</p>
<p>The best defense against becoming an unwitting collaborator is thus to end systems are well-vetted and secure.  Transparency is a major tool in this process <a class='info' href='#secure'>[secure]<span> (</span><span class='info'>Schneier, B., &ldquo;NSA surveillance: A guide to staying secure,&rdquo; 2013.</span><span>)</span></a>.  Open source software is easier to evaluate for potential flaws than proprietary software.  Products that conform to standards for cryptography and security protocols are limited in the ways they can misbehave.  And standards processes that are open and transparent help ensure that the standards themselves do not provide avenues for attack.
</p>
<p>Content exfiltration has some similarity to the dynamic exfiltration case, in that nothing can prevent a collaborator from revealing what he knows, and the mitigations against becoming an unwitting collaborator apply.  In this case, however, applications can limit what the collaborator is able to reveal.  For example, the S/MIME and PGP systems for secure email both deny intermediate servers access to certain parts of the message <a class='info' href='#RFC5750'>[RFC5750]<span> (</span><span class='info'>Ramsdell, B. and S. Turner, &ldquo;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Certificate Handling,&rdquo; January&nbsp;2010.</span><span>)</span></a><a class='info' href='#RFC2015'>[RFC2015]<span> (</span><span class='info'>Elkins, M., &ldquo;MIME Security with Pretty Good Privacy (PGP),&rdquo; October&nbsp;1996.</span><span>)</span></a>.  Even if a server were to provide an attacker with full access, the attacker would still not be able to read the protected parts of the message.  
</p>
<p>The mitigations to the content exfiltration case are thus to regard participants in the protocol as potential passive attackers themselves, and apply the mitigations discussed above with regard to passive attack.  Information that is not necessary for these participants to fulfill their role in the protocol can be encrypted, and other information can be anonymized.
</p>
<p>In summary, many of the basic tools for mitigating pervasive attack already exist.  As Edward Snowden put it, “properly implemented strong crypto systems are one of the few things you can rely on” <a class='info' href='#snowden'>[snowden]<span> (</span><span class='info'>Technology Review, &ldquo;NSA Leak Leaves Crypto-Math Intact but Highlights Known Workarounds,&rdquo; 2013.</span><span>)</span></a>.  The task for the Internet community is to ensure that applications are able to use the strong crypto systems we have defined – for example, TLS with PFS ciphersuites – and that these properly implemented.  (And, one might add, turned on!)  Some of this work will require architectural changes to applications, e.g., in order to limit the information that is exposed to servers.  In many other cases, however, the need is simply to make the best use we can of the cryptographic tools we have.
</p>
<a name="acknowledgements"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p></p>
<ul class="text">
<li>Trammel for ideas around pervasive passive attack and mitigation
</li>
<li>Thaler for list of attacks and taxonomy
</li>
<li>Schneier for suggestions on endpoint security
</li>
<li>Security ADs for starting and managing the perpass discussion
</li>
</ul>

<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="pass1">[pass1]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/jun/27/nsa-online-metadata-collection">How the NSA is still harvesting your online data</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="pass2">[pass2]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/jun/08/nsa-prism-server-collection-facebook-google">NSA's Prism surveillance program: how it works and what it can do</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="pass3">[pass3]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/jul/31/nsa-top-secret-program-online-data">XKeyscore: NSA tool collects 'nearly everything a user does on the internet'</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="pass4">[pass4]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/uk/2013/jun/21/how-does-gchq-internet-surveillance-work">How does GCHQ's internet surveillance work?</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="dec1">[dec1]</a></td>
<td class="author-text">The New York Times, &ldquo;<a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html">N.S.A. Able to Foil Basic Safeguards of Privacy on Web</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="dec2">[dec2]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/interactive/2013/sep/05/nsa-project-bullrun-classification-guide">Project Bullrun – classification guide to the NSA's decryption program</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="dec3">[dec3]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/sep/05/nsa-gchq-encryption-codes-security">Revealed: how US and UK spy agencies defeat internet privacy and security</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="TOR">[TOR]</a></td>
<td class="author-text">The Tor Project, &ldquo;<a href="https://www.torproject.org/">TOR</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="TOR1">[TOR1]</a></td>
<td class="author-text">Schneier, B., &ldquo;<a href="https://www.schneier.com/blog/archives/2013/10/how_the_nsa_att.html">How the NSA Attacks Tor/Firefox Users With QUANTUM and FOXACID</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="TOR2">[TOR2]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/interactive/2013/oct/04/tor-stinks-nsa-presentation-document">'Tor Stinks' presentation – read the full document</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="dir1">[dir1]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/jun/06/nsa-phone-records-verizon-court-order">NSA collecting phone records of millions of Verizon customers daily</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="dir2">[dir2]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/2013/jun/06/us-tech-giants-nsa-data">NSA Prism program taps in to user data of Apple, Google and others</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="std">[std]</a></td>
<td class="author-text">The Guardian, &ldquo;<a href="http://www.theguardian.com/world/interactive/2013/sep/05/sigint-nsa-collaborates-technology-companies">Sigint – how the NSA collaborates with technology companies</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="secure">[secure]</a></td>
<td class="author-text">Schneier, B., &ldquo;<a href="http://www.theguardian.com/world/2013/sep/05/nsa-how-to-remain-secure-surveillance">NSA surveillance: A guide to staying secure</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="snowden">[snowden]</a></td>
<td class="author-text">Technology Review, &ldquo;<a href="http://www.technologyreview.com/news/519171/nsa-leak-leaves-crypto-math-intact-but-highlights-known-workarounds/">NSA Leak Leaves Crypto-Math Intact but Highlights Known Workarounds</a>,&rdquo; 2013.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6962">[RFC6962]</a></td>
<td class="author-text">Laurie, B., Langley, A., and E. Kasper, &ldquo;<a href="http://tools.ietf.org/html/rfc6962">Certificate Transparency</a>,&rdquo; RFC&nbsp;6962, June&nbsp;2013 (<a href="http://www.rfc-editor.org/rfc/rfc6962.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6698">[RFC6698]</a></td>
<td class="author-text">Hoffman, P. and J. Schlyter, &ldquo;<a href="http://tools.ietf.org/html/rfc6698">The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA</a>,&rdquo; RFC&nbsp;6698, August&nbsp;2012 (<a href="http://www.rfc-editor.org/rfc/rfc6698.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5750">[RFC5750]</a></td>
<td class="author-text">Ramsdell, B. and S. Turner, &ldquo;<a href="http://tools.ietf.org/html/rfc5750">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Certificate Handling</a>,&rdquo; RFC&nbsp;5750, January&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5750.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2015">[RFC2015]</a></td>
<td class="author-text">Elkins, M., &ldquo;<a href="http://tools.ietf.org/html/rfc2015">MIME Security with Pretty Good Privacy (PGP)</a>,&rdquo; RFC&nbsp;2015, October&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2015.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2015.xml">XML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richard Barnes</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rlb@ipv.sx">rlb@ipv.sx</a></td></tr>
</table>
</body></html>
